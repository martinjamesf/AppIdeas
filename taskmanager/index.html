<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Task Manager</title>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2rem;
      background: #f4f4f4;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    th, td {
      padding: 0.75rem;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background-color: #007bff;
      color: white;
    }
    .toolbar {
      margin-bottom: 1rem;
    }
    .modal {
      display: none;
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 1.5rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
      z-index: 1000;
    }
    .modal.show {
      display: block;
    }
    .overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 999;
    }
    .overlay.show {
      display: block;
    }
    .button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      margin-right: 0.5rem;
      cursor: pointer;
      border-radius: 4px;
    }
    .button:hover {
      background-color: #0056b3;
    }
    input[type="text"], select {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>

<div class="toolbar">
  <button class="button" onclick="addTask()">Add Task</button>
  <button class="button" onclick="saveData()">Save</button>
</div>

<table id="taskTable">
  <thead>
    <tr>
      <th><input type="checkbox" id="selectAll" onchange="toggleAll(this)"></th>
      <th>Task Name</th>
      <th>Type</th>
      <th>Task Creation Sequence</th>
    </tr>
  </thead>
  <tbody id="taskTbody">
    <!-- Task rows go here -->
  </tbody>
</table>

<div class="overlay" id="modalOverlay"></div>
<div class="modal" id="taskModal">
  <h3>Edit Task</h3>
  <label for="taskName">Task Name</label>
  <input type="text" id="taskName">
  <label for="taskType">Type</label>
  <select id="taskType">
    <option value="Independent">Independent</option>
    <option value="Sequential">Sequential</option>
    <option value="Parallel">Parallel</option>
  </select>
  <label for="taskSequence">Task Creation Sequence</label>
  <input type="text" id="taskSequence">
  <input type="hidden" id="modalRowIndex">
  <button class="button" onclick="saveModal()">Save Task</button>
  <button class="button" onclick="closeModal()">Cancel</button>
</div>

<script>
  const tbody = document.getElementById('taskTbody');

  function addTask() {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td><input type="checkbox" class="rowCheckbox"></td>
      <td contenteditable="true" data-field="name">New Task</td>
      <td contenteditable="true" data-field="type">Independent</td>
      <td contenteditable="true" data-field="sequence">1</td>
    `;
    row.addEventListener('dblclick', () => openModal(row));
    tbody.appendChild(row);
  }

  function toggleAll(source) {
    const checkboxes = document.querySelectorAll('.rowCheckbox');
    checkboxes.forEach(cb => cb.checked = source.checked);
  }

  function openModal(row) {
    document.getElementById('taskName').value = row.querySelector('[data-field="name"]').textContent.trim();
    document.getElementById('taskType').value = row.querySelector('[data-field="type"]').textContent.trim();
    document.getElementById('taskSequence').value = row.querySelector('[data-field="sequence"]').textContent.trim();
    document.getElementById('modalRowIndex').value = [...tbody.children].indexOf(row);
    document.getElementById('taskModal').classList.add('show');
    document.getElementById('modalOverlay').classList.add('show');
  }

  function closeModal() {
    document.getElementById('taskModal').classList.remove('show');
    document.getElementById('modalOverlay').classList.remove('show');
  }

  function saveModal() {
    const index = parseInt(document.getElementById('modalRowIndex').value);
    const row = tbody.children[index];
    row.querySelector('[data-field="name"]').textContent = document.getElementById('taskName').value;
    row.querySelector('[data-field="type"]').textContent = document.getElementById('taskType').value;
    row.querySelector('[data-field="sequence"]').textContent = document.getElementById('taskSequence').value;
    closeModal();
  }

  function saveData() {
    const data = [];
    [...tbody.children].forEach(row => {
      data.push({
        name: row.querySelector('[data-field="name"]').textContent.trim(),
        type: row.querySelector('[data-field="type"]').textContent.trim(),
        sequence: row.querySelector('[data-field="sequence"]').textContent.trim(),
      });
    });
    console.log('Saving Data:', JSON.stringify(data, null, 2));
    // Add your application or eSignature logic here
  }

  new Sortable(tbody, {
    animation: 150,
    handle: 'td',
  });
</script>

</body>
</html>
